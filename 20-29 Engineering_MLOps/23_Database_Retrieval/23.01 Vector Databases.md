---
id: 23.01
tags: [type/concept, status/growing, context/llm, context/data-engineering]
---

# Vector Databases

## Overview
Specialized data stores for high-dimensional vectors (embeddings). Enable semantic search by finding vectors similar to a query vector. Essential for RAG, recommendation engines, and similarity search.

## Similarity Metrics

| Metric | Formula | Range | Best For |
|--------|---------|-------|----------|
| **Cosine** | $\frac{A \cdot B}{\|A\| \|B\|}$ | -1 to 1 | Text embeddings, normalized vectors |
| **Euclidean (L2)** | $\sqrt{\sum (A_i - B_i)^2}$ | 0 to ∞ | Spatial data, un-normalized |
| **Dot Product** | $\sum A_i B_i$ | -∞ to ∞ | Normalized embeddings, fast |
| **Manhattan (L1)** | $\sum |A_i - B_i|$ | 0 to ∞ | High-dimensional sparse data |

## Indexing Algorithms

### HNSW (Hierarchical Navigable Small World)
Graph-based with navigation layers. Fast search O(log n), high memory usage.
- **M**: Connections per node (higher = better recall, more memory)
- **ef**: Search depth (higher = better recall, slower)

### IVF (Inverted File Index)
Partition space into k-means clusters, search only relevant clusters.
- **nlist**: Number of clusters
- **nprobe**: Clusters to search (tradeoff: speed vs recall)

### Product Quantization (PQ)
Compress vectors 20-30× by splitting into subvectors and quantizing to codebooks. Slight accuracy loss.

### Flat Index
Brute-force exact search. 100% recall, O(n) time. Use for <100k vectors.

## Database Comparison

| Database | Type | Best For | Key Feature |
|----------|------|----------|-------------|
| **Pinecone** | Managed | Production, ease of use | Serverless, auto-scaling |
| **Qdrant** | OSS/Cloud | Rich filtering, production | Advanced metadata filters |
| **Weaviate** | OSS/Cloud | Hybrid search | Built-in vectorizers, GraphQL |
| **Chroma** | OSS | Prototyping, embedded | Lightweight, easy setup |
| **Milvus** | OSS | Large scale, GPU | Multiple index types |
| **FAISS** | Library | Research, custom builds | In-memory, extremely fast |

### Managed vs Self-Hosted
- **Managed (Pinecone)**: No ops, higher cost
- **Self-hosted (Qdrant, Milvus)**: More control, ops overhead
- **Embedded (Chroma, FAISS)**: No server, limited scale

## Advanced Features

### Metadata Filtering
Pre-filter vectors before similarity search:
- Filter by category, date range, user permissions
- Reduces search space, improves relevance

### Hybrid Search
Combine vector similarity + keyword (BM25) search:
- `alpha=0`: Pure BM25
- `alpha=1`: Pure vector
- `alpha=0.5`: Balanced

### Multi-Vector Search
Search across multiple embedding fields (title, description) with weighted combination.

### Sharding & Replication
- **Sharding**: Distribute data across nodes for scale
- **Replication**: Duplicate data for reliability

## Performance Tuning

| Dimension | Strategy |
|-----------|----------|
| **Speed** | Lower ef, quantization, fewer clusters to search |
| **Recall** | Higher ef/nprobe, more connections (M) |
| **Memory** | Product quantization, binary quantization |
| **Scale** | Sharding, IVF vs HNSW tradeoff |

## Cost Factors

| Factor | Impact |
|--------|--------|
| Vector dimensions | Storage per vector |
| Number of vectors | Index size, query time |
| Query volume | API/compute costs |
| Index type | Memory requirements |

> [!TIP]
> Use smaller embeddings (384 vs 1536) and quantization to reduce costs significantly.

## Use Cases

- **RAG Systems**: Retrieve context for LLM generation
- **Recommendation**: Find similar items/users
- **Duplicate Detection**: Near-duplicate identification
- **Image Search**: Visual similarity (CLIP embeddings)
- **Anomaly Detection**: Find outliers in embedding space

## Production Checklist

- [ ] Choose appropriate similarity metric
- [ ] Tune index parameters (M, ef, nprobe)
- [ ] Implement backup/snapshot strategy
- [ ] Set up monitoring (latency, recall, throughput)
- [ ] Plan for multi-tenancy if needed
- [ ] Consider embedding versioning

## Related Concepts
- [[23_Database_Retrieval_MOC]] - Parent category
- [[11.12 RAG]] - Primary use case for vector search
- [[23.02 TF-IDF]] - Contrast: keyword-based alternative to semantic search

## References
- "Efficient and Robust Approximate Nearest Neighbor Search" (HNSW paper)
- ann-benchmarks.com - Algorithm comparisons
- Pinecone Learning Center, Qdrant Documentation
