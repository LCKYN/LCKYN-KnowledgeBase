---
id: 71.02
tags: [type/code, status/seed, context/python, context/discord]
---

# Disnake - Discord API Wrapper

## Overview
**Disnake** is a modern, feature-rich Python API wrapper for Discord, forked from discord.py. It provides comprehensive support for Discord's features including slash commands, buttons, select menus, and modals while maintaining backward compatibility with discord.py code.

## Installation

```bash
# Basic installation
pip install disnake

# With voice support
pip install disnake[voice]

# With speed optimizations
pip install disnake[speed]

# Full installation
pip install disnake[voice,speed]
```

## Core Concepts

### Bot Setup

```python
import disnake
from disnake.ext import commands

# Create bot instance
bot = commands.Bot(
    command_prefix="!",
    intents=disnake.Intents.default()
)

# Event: Bot ready
@bot.event
async def on_ready():
    print(f"Logged in as {bot.user} (ID: {bot.user.id})")

# Run the bot
bot.run("YOUR_BOT_TOKEN")
```

### Intents

```python
# Privileged intents (require Discord Developer Portal activation)
intents = disnake.Intents.default()
intents.message_content = True  # Read message content
intents.members = True          # Access member information
intents.presences = True        # Access presence updates

bot = commands.Bot(command_prefix="!", intents=intents)
```

## Slash Commands (Application Commands)

### Basic Slash Command

```python
@bot.slash_command(
    name="hello",
    description="Greet the user"
)
async def hello(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_message(f"Hello, {inter.author.mention}!")
```

### With Parameters

```python
@bot.slash_command(description="Calculate sum of two numbers")
async def add(
    inter: disnake.ApplicationCommandInteraction,
    num1: int = commands.Param(description="First number"),
    num2: int = commands.Param(description="Second number")
):
    result = num1 + num2
    await inter.response.send_message(f"{num1} + {num2} = {result}")
```

### With Choices

```python
@bot.slash_command(description="Get information about a programming language")
async def language(
    inter: disnake.ApplicationCommandInteraction,
    lang: str = commands.Param(
        choices=["Python", "JavaScript", "Rust", "Go"]
    )
):
    await inter.response.send_message(f"You selected: {lang}")
```

### Autocomplete

```python
LANGUAGES = ["Python", "JavaScript", "TypeScript", "Rust", "Go", "Java", "C++"]

@bot.slash_command(description="Search programming language")
async def search_lang(
    inter: disnake.ApplicationCommandInteraction,
    query: str
):
    await inter.response.send_message(f"You searched for: {query}")

@search_lang.autocomplete("query")
async def lang_autocomplete(
    inter: disnake.ApplicationCommandInteraction,
    string: str
):
    # Return matching languages
    return [lang for lang in LANGUAGES if string.lower() in lang.lower()][:25]
```

### Subcommands

```python
@bot.slash_command(description="Manage server settings")
async def config(inter: disnake.ApplicationCommandInteraction):
    pass

@config.sub_command(description="Set welcome channel")
async def welcome(
    inter: disnake.ApplicationCommandInteraction,
    channel: disnake.TextChannel
):
    await inter.response.send_message(f"Welcome channel set to {channel.mention}")

@config.sub_command(description="Set log channel")
async def logs(
    inter: disnake.ApplicationCommandInteraction,
    channel: disnake.TextChannel
):
    await inter.response.send_message(f"Log channel set to {channel.mention}")
```

## Message Components

### Buttons

```python
@bot.slash_command(description="Interactive button example")
async def button_demo(inter: disnake.ApplicationCommandInteraction):
    # Create button
    button = disnake.ui.Button(
        label="Click Me!",
        style=disnake.ButtonStyle.primary,
        custom_id="demo_button"
    )

    # Send message with button
    await inter.response.send_message(
        "Click the button below!",
        components=[button]
    )

# Handle button click
@bot.listen("on_button_click")
async def button_listener(inter: disnake.MessageInteraction):
    if inter.component.custom_id == "demo_button":
        await inter.response.send_message("Button clicked!", ephemeral=True)
```

### Button View (Class-Based)

```python
class MyView(disnake.ui.View):
    def __init__(self):
        super().__init__(timeout=180)  # 3 minutes timeout
        self.value = None

    @disnake.ui.button(label="Approve", style=disnake.ButtonStyle.success)
    async def approve(
        self,
        button: disnake.ui.Button,
        inter: disnake.MessageInteraction
    ):
        self.value = True
        await inter.response.send_message("Approved! ‚úÖ", ephemeral=True)
        self.stop()

    @disnake.ui.button(label="Deny", style=disnake.ButtonStyle.danger)
    async def deny(
        self,
        button: disnake.ui.Button,
        inter: disnake.MessageInteraction
    ):
        self.value = False
        await inter.response.send_message("Denied! ‚ùå", ephemeral=True)
        self.stop()

# Usage
@bot.slash_command(description="Approval system")
async def approve_request(inter: disnake.ApplicationCommandInteraction):
    view = MyView()
    await inter.response.send_message("Please approve or deny:", view=view)

    # Wait for interaction
    await view.wait()

    if view.value is None:
        await inter.edit_original_message(content="Timeout!", view=None)
    elif view.value:
        await inter.edit_original_message(content="Request approved!", view=None)
    else:
        await inter.edit_original_message(content="Request denied!", view=None)
```

### Select Menus

```python
class RoleSelect(disnake.ui.View):
    @disnake.ui.select(
        placeholder="Choose your roles",
        min_values=1,
        max_values=3,
        options=[
            disnake.SelectOption(label="Python", emoji="üêç", value="python"),
            disnake.SelectOption(label="JavaScript", emoji="üìú", value="js"),
            disnake.SelectOption(label="Rust", emoji="ü¶Ä", value="rust"),
            disnake.SelectOption(label="Go", emoji="üîµ", value="go"),
        ]
    )
    async def select_callback(
        self,
        select: disnake.ui.Select,
        inter: disnake.MessageInteraction
    ):
        selected = ", ".join(select.values)
        await inter.response.send_message(
            f"You selected: {selected}",
            ephemeral=True
        )

@bot.slash_command(description="Select your programming languages")
async def choose_roles(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_message("Select your roles:", view=RoleSelect())
```

### Modals (Forms)

```python
class FeedbackModal(disnake.ui.Modal):
    def __init__(self):
        components = [
            disnake.ui.TextInput(
                label="Title",
                placeholder="Brief summary",
                custom_id="title",
                style=disnake.TextInputStyle.short,
                max_length=100
            ),
            disnake.ui.TextInput(
                label="Feedback",
                placeholder="Detailed feedback",
                custom_id="feedback",
                style=disnake.TextInputStyle.paragraph,
                max_length=1000
            )
        ]
        super().__init__(title="Submit Feedback", components=components)

    async def callback(self, inter: disnake.ModalInteraction):
        title = inter.text_values["title"]
        feedback = inter.text_values["feedback"]

        # Process feedback
        await inter.response.send_message(
            f"**Feedback received!**\n**Title:** {title}\n**Message:** {feedback}",
            ephemeral=True
        )

@bot.slash_command(description="Submit feedback")
async def feedback(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_modal(FeedbackModal())
```

## Embeds

### Basic Embed

```python
@bot.slash_command(description="Display an embed")
async def info(inter: disnake.ApplicationCommandInteraction):
    embed = disnake.Embed(
        title="Bot Information",
        description="A helpful Discord bot",
        color=disnake.Color.blue()
    )

    embed.add_field(name="Version", value="1.0.0", inline=True)
    embed.add_field(name="Language", value="Python", inline=True)
    embed.add_field(name="Framework", value="Disnake", inline=True)

    embed.set_footer(text=f"Requested by {inter.author}", icon_url=inter.author.avatar.url)
    embed.set_thumbnail(url=bot.user.avatar.url)
    embed.timestamp = disnake.utils.utcnow()

    await inter.response.send_message(embed=embed)
```

### Advanced Embed

```python
@bot.slash_command(description="User profile")
async def profile(
    inter: disnake.ApplicationCommandInteraction,
    user: disnake.Member = commands.Param(default=lambda inter: inter.author)
):
    embed = disnake.Embed(
        title=f"{user.name}'s Profile",
        color=user.color
    )

    embed.set_thumbnail(url=user.display_avatar.url)

    # Account information
    embed.add_field(
        name="Account Created",
        value=f"<t:{int(user.created_at.timestamp())}:R>",
        inline=True
    )
    embed.add_field(
        name="Joined Server",
        value=f"<t:{int(user.joined_at.timestamp())}:R>",
        inline=True
    )

    # Roles
    roles = [role.mention for role in user.roles[1:]]  # Skip @everyone
    embed.add_field(
        name=f"Roles [{len(roles)}]",
        value=", ".join(roles) if roles else "No roles",
        inline=False
    )

    await inter.response.send_message(embed=embed)
```

## Events

### Message Events

```python
@bot.event
async def on_message(message: disnake.Message):
    if message.author.bot:
        return

    # Auto-react to specific keywords
    if "python" in message.content.lower():
        await message.add_reaction("üêç")

    # Process commands
    await bot.process_commands(message)
```

### Member Events

```python
@bot.event
async def on_member_join(member: disnake.Member):
    # Get welcome channel
    channel = member.guild.system_channel
    if channel:
        embed = disnake.Embed(
            title="Welcome!",
            description=f"{member.mention} has joined the server!",
            color=disnake.Color.green()
        )
        await channel.send(embed=embed)

@bot.event
async def on_member_remove(member: disnake.Member):
    channel = member.guild.system_channel
    if channel:
        await channel.send(f"{member.name} has left the server.")
```

### Reaction Events

```python
@bot.event
async def on_raw_reaction_add(payload: disnake.RawReactionActionEvent):
    # Reaction role system
    if payload.message_id == 123456789:  # Specific message
        guild = bot.get_guild(payload.guild_id)
        member = guild.get_member(payload.user_id)

        role_mapping = {
            "üêç": "Python",
            "üìú": "JavaScript",
            "ü¶Ä": "Rust"
        }

        role_name = role_mapping.get(str(payload.emoji))
        if role_name:
            role = disnake.utils.get(guild.roles, name=role_name)
            if role:
                await member.add_roles(role)
```

## Cogs (Extensions)

### Creating a Cog

```python
# cogs/moderation.py
from disnake.ext import commands
import disnake

class Moderation(commands.Cog):
    def __init__(self, bot):
        self.bot = bot

    @commands.slash_command(description="Kick a member")
    @commands.has_permissions(kick_members=True)
    async def kick(
        self,
        inter: disnake.ApplicationCommandInteraction,
        member: disnake.Member,
        reason: str = "No reason provided"
    ):
        await member.kick(reason=reason)
        await inter.response.send_message(
            f"{member.mention} has been kicked. Reason: {reason}"
        )

    @commands.slash_command(description="Ban a member")
    @commands.has_permissions(ban_members=True)
    async def ban(
        self,
        inter: disnake.ApplicationCommandInteraction,
        member: disnake.Member,
        reason: str = "No reason provided",
        delete_days: int = commands.Param(default=0, ge=0, le=7)
    ):
        await member.ban(reason=reason, delete_message_days=delete_days)
        await inter.response.send_message(
            f"{member.mention} has been banned. Reason: {reason}"
        )

    @commands.Cog.listener()
    async def on_member_ban(self, guild: disnake.Guild, user: disnake.User):
        # Log ban to channel
        log_channel = guild.get_channel(LOG_CHANNEL_ID)
        if log_channel:
            await log_channel.send(f"{user} was banned from the server.")

def setup(bot):
    bot.add_cog(Moderation(bot))
```

### Loading Cogs

```python
# main.py
import os

# Load all cogs from cogs directory
for filename in os.listdir("./cogs"):
    if filename.endswith(".py"):
        bot.load_extension(f"cogs.{filename[:-3]}")

# Or load specific cog
bot.load_extension("cogs.moderation")
```

## Advanced Features

### Cooldowns

```python
from disnake.ext import commands

@bot.slash_command(description="Command with cooldown")
@commands.cooldown(1, 60, commands.BucketType.user)  # 1 use per 60 seconds per user
async def limited(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_message("This command has a cooldown!")

# Handle cooldown error
@limited.error
async def limited_error(inter, error):
    if isinstance(error, commands.CommandOnCooldown):
        await inter.response.send_message(
            f"This command is on cooldown. Try again in {error.retry_after:.2f}s",
            ephemeral=True
        )
```

### Error Handling

```python
@bot.event
async def on_slash_command_error(
    inter: disnake.ApplicationCommandInteraction,
    error: commands.CommandError
):
    if isinstance(error, commands.MissingPermissions):
        await inter.response.send_message(
            "You don't have permission to use this command!",
            ephemeral=True
        )
    elif isinstance(error, commands.CommandOnCooldown):
        await inter.response.send_message(
            f"Cooldown active. Retry in {error.retry_after:.1f}s",
            ephemeral=True
        )
    else:
        await inter.response.send_message(
            f"An error occurred: {str(error)}",
            ephemeral=True
        )
```

### Tasks (Background Loop)

```python
from disnake.ext import tasks

@tasks.loop(hours=24)
async def daily_task():
    channel = bot.get_channel(CHANNEL_ID)
    await channel.send("Daily reminder!")

@daily_task.before_loop
async def before_daily_task():
    await bot.wait_until_ready()

# Start the task
daily_task.start()
```

### Context Menus

```python
# User context menu (right-click user -> Apps)
@bot.user_command(name="User Info")
async def user_info(inter: disnake.UserCommandInteraction, user: disnake.User):
    embed = disnake.Embed(
        title=f"Info for {user.name}",
        color=disnake.Color.blue()
    )
    embed.add_field(name="ID", value=user.id)
    embed.add_field(name="Created", value=f"<t:{int(user.created_at.timestamp())}:R>")
    await inter.response.send_message(embed=embed, ephemeral=True)

# Message context menu (right-click message -> Apps)
@bot.message_command(name="Quote Message")
async def quote(inter: disnake.MessageCommandInteraction, message: disnake.Message):
    embed = disnake.Embed(
        description=message.content,
        color=disnake.Color.blue()
    )
    embed.set_author(
        name=message.author.display_name,
        icon_url=message.author.display_avatar.url
    )
    await inter.response.send_message(embed=embed)
```

## Best Practices

### Ephemeral Responses

```python
@bot.slash_command(description="Private response")
async def secret(inter: disnake.ApplicationCommandInteraction):
    # Only visible to command user
    await inter.response.send_message("This is private!", ephemeral=True)
```

### Deferred Responses

```python
@bot.slash_command(description="Long operation")
async def process(inter: disnake.ApplicationCommandInteraction):
    # Defer response for operations taking >3 seconds
    await inter.response.defer()

    # Perform long operation
    result = await long_running_task()

    # Send actual response
    await inter.followup.send(f"Result: {result}")
```

### Permission Checks

```python
@bot.slash_command(description="Admin only command")
@commands.has_permissions(administrator=True)
async def admin_cmd(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_message("Admin command executed!")

# Custom check
def is_staff():
    async def predicate(inter: disnake.ApplicationCommandInteraction) -> bool:
        staff_role = disnake.utils.get(inter.guild.roles, name="Staff")
        return staff_role in inter.author.roles
    return commands.check(predicate)

@bot.slash_command(description="Staff only")
@is_staff()
async def staff_cmd(inter: disnake.ApplicationCommandInteraction):
    await inter.response.send_message("Staff command!")
```

### Environment Variables

```python
import os
from dotenv import load_dotenv

load_dotenv()

TOKEN = os.getenv("DISCORD_TOKEN")
bot.run(TOKEN)
```

## Common Patterns

### Pagination

```python
class Paginator(disnake.ui.View):
    def __init__(self, embeds: list[disnake.Embed]):
        super().__init__(timeout=180)
        self.embeds = embeds
        self.current = 0

    @disnake.ui.button(emoji="‚¨ÖÔ∏è", style=disnake.ButtonStyle.primary)
    async def previous(self, button: disnake.ui.Button, inter: disnake.MessageInteraction):
        self.current = (self.current - 1) % len(self.embeds)
        await inter.response.edit_message(embed=self.embeds[self.current])

    @disnake.ui.button(emoji="‚û°Ô∏è", style=disnake.ButtonStyle.primary)
    async def next(self, button: disnake.ui.Button, inter: disnake.MessageInteraction):
        self.current = (self.current + 1) % len(self.embeds)
        await inter.response.edit_message(embed=self.embeds[self.current])

# Usage
@bot.slash_command(description="Paginated help")
async def help_pages(inter: disnake.ApplicationCommandInteraction):
    embeds = [
        disnake.Embed(title="Page 1", description="Commands: /help, /info"),
        disnake.Embed(title="Page 2", description="Commands: /kick, /ban"),
        disnake.Embed(title="Page 3", description="Commands: /mute, /warn"),
    ]
    view = Paginator(embeds)
    await inter.response.send_message(embed=embeds[0], view=view)
```

### Database Integration

```python
import aiosqlite

class Database:
    def __init__(self, db_path: str):
        self.db_path = db_path

    async def setup(self):
        async with aiosqlite.connect(self.db_path) as db:
            await db.execute("""
                CREATE TABLE IF NOT EXISTS users (
                    user_id INTEGER PRIMARY KEY,
                    points INTEGER DEFAULT 0
                )
            """)
            await db.commit()

    async def add_points(self, user_id: int, points: int):
        async with aiosqlite.connect(self.db_path) as db:
            await db.execute(
                "INSERT INTO users (user_id, points) VALUES (?, ?) "
                "ON CONFLICT(user_id) DO UPDATE SET points = points + ?",
                (user_id, points, points)
            )
            await db.commit()

    async def get_points(self, user_id: int) -> int:
        async with aiosqlite.connect(self.db_path) as db:
            async with db.execute(
                "SELECT points FROM users WHERE user_id = ?",
                (user_id,)
            ) as cursor:
                row = await cursor.fetchone()
                return row[0] if row else 0

# Initialize database
db = Database("bot.db")

@bot.event
async def on_ready():
    await db.setup()
    print("Database ready!")
```

## Key Differences from discord.py

| Feature | discord.py | Disnake |
|---------|-----------|---------|
| Slash Commands | `@app_commands.command()` | `@bot.slash_command()` |
| Interaction Type | `discord.Interaction` | `disnake.ApplicationCommandInteraction` |
| Command Groups | `app_commands.Group` | `@command.sub_command()` |
| Message Components | Similar | Enhanced autocomplete |
| Maintenance | Archived (2021) | Active development |

## Resources

- [Official Documentation](https://docs.disnake.dev/)
- [GitHub Repository](https://github.com/DisnakeDev/disnake)
- [Discord Server](https://discord.gg/disnake)
- [Migration Guide from discord.py](https://docs.disnake.dev/en/stable/migrating.html)

## Related Concepts

- [[71.01 Python 3.14]] - Python version compatibility
- Async/await patterns in Python
- Discord API fundamentals
- Bot hosting and deployment

## Further Reading

- Discord Developer Portal documentation
- OAuth2 and bot permissions
- Rate limiting and best practices
- Advanced bot architectures
