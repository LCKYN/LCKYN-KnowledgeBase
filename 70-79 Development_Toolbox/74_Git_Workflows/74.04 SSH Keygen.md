---
id: 74.04
tags: [type/code, status/evergreen, context/dev-tools, context/devops]
---

# SSH Keygen

## Overview
**SSH keys** provide passwordless, cryptographically secure authentication for remote servers, file transfers, and Git services. `ssh-keygen` generates a public/private key pair — the private key stays on your machine, the public key goes to the remote host or service.

## Generate a New SSH Key

```bash
# Ed25519 (recommended — fast, secure, short keys)
ssh-keygen -t ed25519 -C "your_email@example.com"

# RSA 4096 (legacy compatibility)
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
```

Prompts:
1. **File location** — Press Enter for default (`~/.ssh/id_ed25519`)
2. **Passphrase** — Optional but recommended for extra security

## Algorithm Comparison

| Algorithm | Key Size | Security | Speed | Recommendation |
|---|---|---|---|---|
| **Ed25519** | 256-bit | Excellent | Fastest | ✅ Default choice |
| **RSA** | 4096-bit | Good | Slower | Legacy systems only |
| **ECDSA** | 256/384/521 | Good | Fast | Avoid (implementation concerns) |
| **DSA** | 1024-bit | Weak | — | ❌ Deprecated |

## Add Key to SSH Agent

```bash
# Start ssh-agent
eval "$(ssh-agent -s)"

# Add key (macOS — stores passphrase in Keychain)
ssh-add --apple-use-keychain ~/.ssh/id_ed25519

# Add key (Linux)
ssh-add ~/.ssh/id_ed25519
```

## SSH Remote Access

### Connect to a Remote Server

```bash
ssh user@hostname
ssh -p 2222 user@192.168.1.100   # custom port
ssh -i ~/.ssh/my_key user@host   # specific key
```

### Copy Public Key to Server

```bash
# Recommended method
ssh-copy-id user@hostname

# Manual method
cat ~/.ssh/id_ed25519.pub | ssh user@hostname "mkdir -p ~/.ssh && cat >> ~/.ssh/authorized_keys"
```

### File Transfer (SCP / rsync)

```bash
# Copy file to remote
scp file.txt user@host:/remote/path/

# Copy directory recursively
scp -r ./local_dir user@host:/remote/path/

# rsync (preferred — resumable, delta sync)
rsync -avz ./local_dir/ user@host:/remote/path/
```

### SSH Tunneling (Port Forwarding)

```bash
# Local forward — access remote service on local port
ssh -L 8888:localhost:8888 user@gpu-server    # Jupyter notebook
ssh -L 5432:localhost:5432 user@db-server     # PostgreSQL

# Remote forward — expose local service to remote
ssh -R 8080:localhost:3000 user@remote-server
```

> [!TIP] Common ML use case
> Forward Jupyter from a GPU server: `ssh -L 8888:localhost:8888 user@gpu-server`, then open `localhost:8888` in your browser.

## SSH Config File

`~/.ssh/config` — define host aliases to avoid typing full connection details:

```
# GPU training server
Host gpu
  HostName 10.0.1.50
  User ubuntu
  IdentityFile ~/.ssh/id_ed25519
  Port 22
  ForwardAgent yes

# Jump/bastion host
Host bastion
  HostName bastion.example.com
  User admin

# Access internal server through bastion
Host internal
  HostName 10.0.0.5
  User ubuntu
  ProxyJump bastion
```

Then simply: `ssh gpu`, `scp model.pkl gpu:/models/`

### Useful Config Options

| Option | Purpose |
|---|---|
| `IdentityFile` | Specify which key to use |
| `Port` | Custom SSH port |
| `ForwardAgent yes` | Forward local SSH agent to remote |
| `ProxyJump` | Connect via bastion/jump host |
| `ServerAliveInterval 60` | Keep connection alive |
| `AddKeysToAgent yes` | Auto-add key to agent on use |
| `UseKeychain yes` | macOS Keychain integration |

## Git Remote (SSH)

### Add Public Key to GitHub

```bash
# Copy public key to clipboard
pbcopy < ~/.ssh/id_ed25519.pub    # macOS
xclip -sel clip < ~/.ssh/id_ed25519.pub  # Linux
```

Then: **GitHub → Settings → SSH and GPG keys → New SSH key → Paste**

### Verify Connection

```bash
ssh -T git@github.com
# Hi username! You've successfully authenticated...
```

### Multiple Git Keys (Work + Personal)

```
# ~/.ssh/config
Host github.com-personal
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_personal

Host github.com-work
  HostName github.com
  User git
  IdentityFile ~/.ssh/id_ed25519_work
```

Then clone with the alias:

```bash
git clone git@github.com-work:org/repo.git
```

## Common Issues

| Problem | Fix |
|---|---|
| `Permission denied (publickey)` | Key not added to agent or remote host |
| `Too many authentication failures` | Specify key in `~/.ssh/config` |
| Agent not running | Run `eval "$(ssh-agent -s)"` |
| Wrong key used | Set `IdentityFile` in SSH config |
| Key has wrong permissions | `chmod 600 ~/.ssh/id_ed25519` |
| `Host key verification failed` | Remove old entry: `ssh-keygen -R hostname` |
| Connection timeout | Check firewall, port, `ServerAliveInterval` |

> [!WARNING] Protect your private key
> Never share `id_ed25519` (no `.pub`). Only the `.pub` file goes to remote services. Set permissions: `chmod 600 ~/.ssh/id_ed25519`, `chmod 700 ~/.ssh/`.

## Related Concepts
- [[74_Git_Workflows_MOC]] - Parent category
- [[74.01 Conventional Commits]] - Commit standards after SSH setup
